# ビルドと実行のためのベースイメージとして公式のNode.jsイメージを使用
# 適切なバージョンを指定することを推奨 (例: node:20-slim)
FROM node:latest

# コンテナ内の作業ディレクトリを設定
WORKDIR /app

# コンテナ起動時に実行されるデフォルトコマンド
# プロジェクト初期化後は、開発サーバー起動コマンドに書き換える (docker-compose.yml でオーバーライド)
# 初期化段階では、コンテナを起動したままにしておくなど、特に何もしないか、シェルを起動するような設定も考えられるが、
# 今回は docker compose run でコマンドを直接実行するので、ここでは一旦ビルドが成功する最小限の内容とする
# 最終的な開発用としては、npm run dev -- --host を指定する想定
# CMD ["tail", "-f", "/dev/null"] # コンテナを起動したままにする例

# プロジェクト初期化後に依存関係をインストールする際にキャッシュを効かせるため、
# ここで package*.json を先にコピーしておく（初期化前は存在しないが、手順として残しておく）
# COPY package*.json ./

# 後でプロジェクト初期化コマンドを実行し、ファイルが生成された後に npm install を行う

# Viteの開発サーバーがリッスンするポートを公開
EXPOSE 5173

# 開発サーバー起動時のコマンド (docker-compose.ymlでオーバーライドして使用)
# CMD ["npm", "run", "dev", "--", "--host"]